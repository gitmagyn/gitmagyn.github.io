<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ranking Elo</title>
  <style>
    /* Reset básico */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      color: #333;
      padding: 20px;
    }
    header {
      text-align: center;
      margin-bottom: 20px;
    }
    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }
    table {
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      border-collapse: collapse;
      background: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    thead {
      background: #333;
      color: #fff;
    }
    th, td {
      padding: 12px 15px;
      text-align: center;
      border-bottom: 1px solid #ddd;
    }
    tbody tr:hover {
      background: #f1f1f1;
    }
    img.flag {
      width: 32px;
      height: auto;
    }
    #admin-panel {
      max-width: 800px;
      margin: 20px auto;
      background: #fff;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    #admin-panel h2 {
      margin-bottom: 10px;
    }
    #admin-panel form {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    #admin-panel input[type="text"],
    #admin-panel input[type="number"] {
      flex: 1;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    #admin-panel button {
      padding: 8px 15px;
      border: none;
      background: #333;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }
    #admin-panel button:hover {
      background: #555;
    }
    .action-btn {
      padding: 5px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 0 2px;
    }
    .edit-btn {
      background: #007BFF;
      color: #fff;
    }
    .edit-btn:hover {
      background: #0056b3;
    }
    .delete-btn {
      background: #dc3545;
      color: #fff;
    }
    .delete-btn:hover {
      background: #a71d2a;
    }
  </style>
</head>
<body>
  <header>
    <h1>Ranking Elo</h1>
    <p>Ranking de jogadores com pontuações pré-definidas</p>
  </header>

  <!-- Painel de Administração: exibido somente se o parâmetro token estiver correto -->
  <div id="admin-panel" style="display:none;">
    <h2>Adicionar Novo Jogador</h2>
    <form id="add-player-form">
      <input type="text" id="nome" placeholder="Nome do Jogador" required>
      <input type="number" id="elo" placeholder="Elo" required>
      <input type="text" id="pais" placeholder="País" required>
      <input type="text" id="flag" placeholder="URL da Bandeira" required>
      <button type="submit">Adicionar Jogador</button>
    </form>
  </div>

  <table>
    <thead>
      <tr id="table-header">
        <th>Posição</th>
        <th>Bandeira</th>
        <th>Jogador</th>
        <th>Elo</th>
        <!-- A coluna de Ação (edit e delete) será adicionada para admin -->
      </tr>
    </thead>
    <tbody id="ranking-body">
      <!-- As linhas serão inseridas via JavaScript -->
    </tbody>
  </table>

  <script>
    // Dados iniciais dos jogadores
    let jogadores = [
      { nome: "Magnus Carlsen", elo: 2862, pais: "Noruega", flag: "https://upload.wikimedia.org/wikipedia/commons/d/d9/Flag_of_Norway.svg" },
      { nome: "Fabiano Caruana", elo: 2820, pais: "Estados Unidos", flag: "https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" },
      { nome: "Ding Liren", elo: 2791, pais: "China", flag: "https://upload.wikimedia.org/wikipedia/commons/0/0d/Flag_of_China.svg" },
      { nome: "Ian Nepomniachtchi", elo: 2789, pais: "Rússia", flag: "https://upload.wikimedia.org/wikipedia/en/f/f3/Flag_of_Russia.svg" },
      { nome: "Hikaru Nakamura", elo: 2778, pais: "Estados Unidos", flag: "https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg" },
      { nome: "Levon Aronian", elo: 2755, pais: "Armênia", flag: "https://upload.wikimedia.org/wikipedia/commons/2/2f/Flag_of_Armenia.svg" }
    ];

    // Carrega os dados salvos no localStorage (se houver)
    const savedPlayers = localStorage.getItem('jogadores');
    if (savedPlayers) {
      jogadores = JSON.parse(savedPlayers);
    }

    // Verifica se o usuário é admin com base no parâmetro da URL
    const params = new URLSearchParams(window.location.search);
    const isAdmin = params.get("token") === "isadmintrue";

    // Se for admin, exibe o painel de administração e adiciona coluna de ação à tabela
    if (isAdmin) {
      document.getElementById("admin-panel").style.display = "block";
      const headerRow = document.getElementById("table-header");
      const thAcao = document.createElement("th");
      thAcao.textContent = "Ação";
      headerRow.appendChild(thAcao);
    }

    // Função para salvar os dados no localStorage
    function savePlayers() {
      localStorage.setItem('jogadores', JSON.stringify(jogadores));
    }

    // Função para renderizar a tabela de jogadores
    function renderTable() {
      // Ordena os jogadores pelo Elo de forma decrescente
      jogadores.sort((a, b) => b.elo - a.elo);
      const tbody = document.getElementById("ranking-body");
      tbody.innerHTML = "";

      jogadores.forEach((jogador, index) => {
        const tr = document.createElement("tr");

        // Coluna de Posição
        const tdPos = document.createElement("td");
        tdPos.textContent = index + 1;
        tr.appendChild(tdPos);

        // Coluna da Bandeira (apenas a imagem)
        const tdFlag = document.createElement("td");
        const img = document.createElement("img");
        img.src = jogador.flag;
        img.alt = jogador.pais;
        img.className = "flag";
        tdFlag.appendChild(img);
        tr.appendChild(tdFlag);

        // Coluna do Nome do Jogador
        const tdNome = document.createElement("td");
        tdNome.textContent = jogador.nome;
        tr.appendChild(tdNome);

        // Coluna do Elo
        const tdElo = document.createElement("td");
        tdElo.textContent = jogador.elo;
        tr.appendChild(tdElo);

        // Coluna de Ação (edição e exclusão, somente para admin)
        if (isAdmin) {
          const tdAcao = document.createElement("td");

          // Botão Editar
          const btnEdit = document.createElement("button");
          btnEdit.textContent = "Edit";
          btnEdit.className = "action-btn edit-btn";
          btnEdit.addEventListener("click", () => editPlayer(index));
          tdAcao.appendChild(btnEdit);

          // Botão Deletar
          const btnDelete = document.createElement("button");
          btnDelete.textContent = "Delete";
          btnDelete.className = "action-btn delete-btn";
          btnDelete.addEventListener("click", () => deletePlayer(index));
          tdAcao.appendChild(btnDelete);

          tr.appendChild(tdAcao);
        }

        tbody.appendChild(tr);
      });
    }

    // Função para editar um jogador (modo admin)
    function editPlayer(index) {
      const jogador = jogadores[index];
      const novoNome = prompt("Editar nome do jogador:", jogador.nome);
      if (novoNome !== null && novoNome.trim() !== "") {
        jogador.nome = novoNome.trim();
      }
      const novoElo = prompt("Editar Elo do jogador:", jogador.elo);
      if (novoElo !== null && !isNaN(novoElo) && novoElo.trim() !== "") {
        jogador.elo = parseInt(novoElo);
      }
      // Permite editar também o país e a URL da bandeira, se desejar
      const novoPais = prompt("Editar país do jogador:", jogador.pais);
      if (novoPais !== null && novoPais.trim() !== "") {
        jogador.pais = novoPais.trim();
      }
      const novaFlag = prompt("Editar URL da bandeira:", jogador.flag);
      if (novaFlag !== null && novaFlag.trim() !== "") {
        jogador.flag = novaFlag.trim();
      }
      savePlayers();
      renderTable();
    }

    // Função para deletar um jogador (modo admin)
    function deletePlayer(index) {
      if (confirm("Tem certeza que deseja deletar este jogador?")) {
        jogadores.splice(index, 1);
        savePlayers();
        renderTable();
      }
    }

    // Manipula o envio do formulário para adicionar um novo jogador (modo admin)
    if (isAdmin) {
      document.getElementById("add-player-form").addEventListener("submit", (e) => {
        e.preventDefault();
        const nomeInput = document.getElementById("nome");
        const eloInput = document.getElementById("elo");
        const paisInput = document.getElementById("pais");
        const flagInput = document.getElementById("flag");

        const novoJogador = {
          nome: nomeInput.value.trim(),
          elo: parseInt(eloInput.value),
          pais: paisInput.value.trim(),
          flag: flagInput.value.trim()
        };

        jogadores.push(novoJogador);
        savePlayers();
        nomeInput.value = "";
        eloInput.value = "";
        paisInput.value = "";
        flagInput.value = "";
        renderTable();
      });
    }

    // Renderiza a tabela ao carregar a página
    renderTable();
  </script>
</body>
</html>
